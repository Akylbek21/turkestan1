<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–î–∂—É–º–∞-–º–µ—á–µ—Ç—å ‚Äî Turkestan Guide</title>
<link rel="stylesheet" href="../css/main.css"/>
</head>
<body>
<header>
  <div class="container" style="display:flex;gap:10px;align-items:center">
    <a href="../index.html" class="badge" style="text-decoration:none">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    <h1 id="title">–î–∂—É–º–∞-–º–µ—á–µ—Ç—å</h1>
  </div>
</header>

<img class="place-hero" alt="">
<main class="main">
  <div class="loc" id="loc"></div>
  <p class="lead" id="lead"></p>

  <div class="actions">
    <button class="btn primary" id="mark" type="button">–ë—ã–ª –∑–¥–µ—Å—å</button>
    <a class="btn" id="map" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å –≤ Google Maps</a>
    <button class="btn" id="share" type="button">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
  </div>

  <section class="section">
    <h3>–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã</h3>
    <ul id="facts"></ul>
  </section>

  <section class="section quiz">
    <h3>–ü—Ä–æ–≤–µ—Ä—å –∑–Ω–∞–Ω–∏—è</h3>
    <div id="quiz"></div>
    <div class="actions"><button class="btn" id="check" type="button">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button></div>
  </section>

  <section class="recon" aria-label="–ü—Ä–æ—à–ª–æ–µ / —Å–µ–≥–æ–¥–Ω—è">
    <div class="recon-head">
      <h3 style="margin:0">–ü—Ä–æ—à–ª–æ–µ / —Å–µ–≥–æ–¥–Ω—è</h3>
      <small class="muted">–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–∑—É–Ω–æ–∫</small>
    </div>
    <div class="recon-wrap">
      <img class="recon-img" alt="–°–µ–≥–æ–¥–Ω—è">
      <div class="recon-overlay"><img id="recon-then" alt="–ü—Ä–æ—à–ª–æ–µ"></div>
      <input id="recon-slider" class="recon-slider" type="range" min="0" max="100" value="50"/>
    </div>
  </section>
</main>

<footer><div class="container">¬© <span id="y"></span> Turkestan Guide</div></footer>

<!-- 1) –î–ê–ù–ù–´–ï –ú–ï–°–¢–ê ‚Äî —Å–Ω–∞—á–∞–ª–∞ -->
<script>
window.PLACE = {
  id:'juma',
  name:'–î–∂—É–º–∞-–º–µ—á–µ—Ç—å',
  loc:'–≥. –¢—É—Ä–∫–µ—Å—Ç–∞–Ω',
  category:'–ú–µ—á–µ—Ç—å',
  img:'../img/juma.webp',             // —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç; –∏–Ω–∞—á–µ –ø–æ–º–µ–Ω—è–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
  lead:'–ü—è—Ç–Ω–∏—á–Ω–∞—è –º–µ—á–µ—Ç—å XVI –≤–µ–∫–∞, –∏–∑–≤–µ—Å—Ç–Ω–∞—è –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–Ω–∞–º–∏.',
  facts:[
    '–ü–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –¥–∞–Ω–Ω—ã–º, –¥—Ä–µ–≤–µ—Å–∏–Ω–∞ –¥–ª—è –∫–æ–ª–æ–Ω–Ω –ø—Ä–∏–≤–µ–∑–µ–Ω–∞ –∏–∑ –ò–Ω–¥–∏–∏.',
    '–ë—ã–ª–∞ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–º –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ü–µ–Ω—Ç—Ä–æ–º –≥–æ—Ä–æ–¥–∞.',
    '–ö–∏—Ä–ø–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–µ–∑—å–±–æ–π –∏ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ —É–∑–æ—Ä–∞–º–∏.'
  ],
  questions:[
    {q:'–ì–ª–∞–≤–Ω–∞—è –º–æ–ª–∏—Ç–≤–∞ –ø–æ –ø—è—Ç–Ω–∏—Ü–∞–º –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è‚Ä¶', a:['–î–∂—É–º–∞-–Ω–∞–º–∞–∑','–¢–∞—Ä–∞—É–∏—Ö-–Ω–∞–º–∞–∑','–ê–π—Ç-–Ω–∞–º–∞–∑'], ok:0},
    {q:'–ò–∑ –∫–∞–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∫–æ–ª–æ–Ω–Ω—ã?',   a:['–î–µ—Ä–µ–≤–æ','–ö–∏—Ä–ø–∏—á','–ú—Ä–∞–º–æ—Ä'],               ok:0}
  ]
  // –ï—Å–ª–∏ –±—É–¥–µ—Ç —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –¥–æ–±–∞–≤—å:
  // ,recon:{ now:'../img/juma-now.jpg', then:'../img/juma-then.jpg' }
};
</script>

<!-- 2) –†–ï–ù–î–ï–† –í DOM -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const P = window.PLACE || {};
  const $ = (s,root=document)=>root.querySelector(s);

  const Y = $('#y'); Y && (Y.textContent = new Date().getFullYear());

  const title = $('#title');
  const loc   = $('#loc');
  const lead  = $('#lead');
  const facts = $('#facts');
  const quiz  = $('#quiz');
  const mapA  = $('#map');

  // –û–±–ª–æ–∂–∫–∞ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º .place-hero)
  const cover = $('.place-hero');
  if (cover) {
    const src = P.img || ('../img/'+(P.id||'placeholder')+'.webp');
    cover.src = src;
    cover.alt = P.name || '';
    cover.onerror = () => { cover.style.display='none'; };
  }

  // –¢–µ–∫—Å—Ç
  if (title) title.textContent = P.name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
  if (loc)   loc.textContent   = P.loc  || '';
  if (lead)  lead.textContent  = P.lead || '';

  // –§–∞–∫—Ç—ã
  if (facts && Array.isArray(P.facts)) {
    facts.innerHTML = P.facts.map(t=>`<li>‚úÖ ${esc(t)}</li>`).join('');
  }

  // –í–∏–∫—Ç–æ—Ä–∏–Ω–∞
  if (quiz && Array.isArray(P.questions)) {
    quiz.innerHTML = P.questions.map((q,i)=>`
      <div class="q" data-i="${i}">
        <h4 style="margin:0 0 6px">${esc(q.q)}</h4>
        ${q.a.map((opt,idx)=>`<label style="display:block;margin:6px 0">
          <input type="radio" name="q${i}" value="${idx}"> ${esc(opt)}
        </label>`).join('')}
        <div class="muted res" style="margin-top:6px"></div>
      </div>
    `).join('');
    const checkBtn = document.getElementById('check');
    checkBtn && checkBtn.addEventListener('click', () => {
      quiz.querySelectorAll('.q').forEach(box=>{
        const i = +box.dataset.i;
        const ok = (P.questions[i].ok|0);
        const picked = box.querySelector('input[type=radio]:checked');
        const res = box.querySelector('.res');
        if (!picked) { res.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç'; return; }
        res.textContent = (+picked.value===ok) ? '–í–µ—Ä–Ω–æ! üéâ' : '–ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë.';
      });
    });
  }

  // –ö–∞—Ä—Ç–∞
  if (mapA) {
    mapA.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent((P.name||'')+' '+(P.loc||''))}`;
  }

  // –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (–µ—Å–ª–∏ –Ω–µ—Ç –∫–∞—Ä—Ç–∏–Ω–æ–∫ ‚Äî —Å–∫—Ä—ã–≤–∞–µ–º –±–ª–æ–∫)
  const reconWrap = document.querySelector('.recon');
  if (!(P.recon && P.recon.now && P.recon.then)) {
    reconWrap && (reconWrap.style.display='none');
  } else {
    const nowImg  = $('.recon-img', reconWrap);
    const thenImg = $('#recon-then', reconWrap) || $('.recon-overlay img', reconWrap);
    const slider  = $('#recon-slider', reconWrap) || $('.recon-slider', reconWrap);
    nowImg && (nowImg.src = P.recon.now);
    thenImg && (thenImg.src = P.recon.then);
    if (slider && thenImg) {
      slider.addEventListener('input', ()=> {
        const right = 100 - parseInt(slider.value,10);
        thenImg.style.clipPath = `inset(0 ${right}% 0 0)`;
      });
    }
  }

  // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è (–≤–∫–ª. Web Share API + fallback)
  const shareBtn = document.getElementById('share');
  shareBtn && shareBtn.addEventListener('click', async () => {
    const url = location.href;
    const text = `${P.name} ‚Äî ${P.loc}`;
    try {
      if (navigator.share) {
        await navigator.share({ title: P.name, text, url });
      } else {
        await navigator.clipboard.writeText(url);
        toast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
      }
    } catch(_) {}
  });

  function esc(s){return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]))}
  function toast(msg){
    const t=document.createElement('div');
    t.textContent=msg;
    t.style.cssText='position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:rgba(14,165,233,.95);color:#05201a;padding:10px 14px;border-radius:12px;font:600 14px system-ui;z-index:9999;box-shadow:0 10px 30px rgba(0,0,0,.25)';
    document.body.appendChild(t); setTimeout(()=>{t.style.transition='opacity .3s'; t.style.opacity='0';},1400); setTimeout(()=>t.remove(),1800);
  }
});
</script>

<!-- 3) –õ–û–ì–ò–ö–ê ¬´–ë—ã–ª –∑–¥–µ—Å—å¬ª ‚Äî –ü–û–°–õ–ï window.PLACE -->
<script src="../js/place-page.js" defer></script>
</body>
</html>
