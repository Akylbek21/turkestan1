<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title id="doc-title">Place â€” Turkestan Guide</title>
<link rel="stylesheet" href="../css/main.css"/>
</head>
<body>
<header>
  <div class="container" style="display:flex;gap:10px;align-items:center">
    <a href="../index.html" class="badge" style="text-decoration:none">â† Home</a>
    <h1 id="title">Place</h1>
  </div>
</header>

<img class="place-hero" alt="">
<main class="main">
  <div class="loc" id="loc"></div>
  <p class="lead" id="lead"></p>

  <div class="actions">
    <button class="btn primary" id="mark" type="button">I was here</button>
    <a class="btn" id="map" target="_blank" rel="noopener">Open in Google Maps</a>
    <button class="btn" id="share" type="button">Share</button>
  </div>

  <section class="section">
    <h3>Interesting facts</h3>
    <ul id="facts"></ul>
  </section>

  <section class="section quiz">
    <h3>Check your knowledge</h3>
    <div id="quiz"></div>
    <div class="actions"><button class="btn" id="check" type="button">Check</button></div>
  </section>

  <section class="recon" aria-label="Past / Today">
    <div class="recon-head">
      <h3 style="margin:0">Past / Today</h3>
      <small class="muted">Drag the slider</small>
    </div>
    <div class="recon-wrap">
      <img class="recon-img" alt="Today">
      <div class="recon-overlay"><img id="recon-then" alt="Past"></div>
      <input id="recon-slider" class="recon-slider" type="range" min="0" max="100" value="50"/>
    </div>
  </section>
</main>

<footer>
  <div class="container">Â© <span id="y"></span> Turkestan Guide</div>
</footer>

<!-- === Ğ’Ğ¡Ğ¢ĞĞ’Ğ¬Ğ¢Ğ• Ğ¡Ğ®Ğ”Ğ Ğ¾Ğ±ÑŠĞµĞºÑ‚ window.PLACE Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ° 2 Ğ´Ğ»Ñ Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ³Ğ¾ id === -->
<script>
window.PLACE={
  id:'munlyq-zarlyq',
  name:'Munlyqâ€“Zarlyq Memorial Sites',
  loc:'Arys district (Akqala & Zhideli areas)',
  category:'ĞšÑƒĞ»ÑŒÑ‚ÑƒÑ€Ğ°',
   img:'../img/munlyk-zarlyk.webp',
  lead:'Memorial traces tied to the epic â€œMunlyqâ€“Zarlyqâ€: graves, ruins and place-names preserved in local lore.',
  facts:[
    'Munlyqâ€™s grave lies near Akqala old cemetery; Zarlyqâ€™s grave near Zhideli.',
    'Legends mention â€œKhan-shaÑ–m Islandâ€ and the â€œShÃ¶girli groveâ€.',
    'A symbolic monument to Munlyqâ€“Zarlyq stands in Arys city.'
  ],
  questions:[
    {q:'Which literary work is linked to the sites?', a:['â€œMunlyqâ€“Zarlyqâ€','â€œManasâ€ only','â€œShahnamehâ€ only'], ok:0},
    {q:'Which district hosts these memorials?', a:['Arys district','Sairam district','Atyrau city'], ok:0}
  ]
};
</script>

<script>
/* Generic renderer (EN) */
document.addEventListener('DOMContentLoaded',()=>{
  const P=window.PLACE||{};
  const $=(s,r=document)=>r.querySelector(s);

  const y=$('#y'); if(y) y.textContent=new Date().getFullYear();

  const h1=$('#title'); const doc=$('#doc-title');
  h1&&(h1.textContent=P.name||'Untitled');
  doc&&(doc.textContent=(P.name?P.name+' â€” ':'')+'Turkestan Guide');

  const loc=$('#loc'); loc&&(loc.textContent=P.loc||'');
  const lead=$('#lead'); lead&&(lead.textContent=P.lead||'');

  const cover=$('.place-hero');
  if(cover){
    const src=P.img||('../img/'+(P.id||'placeholder')+'.webp');
    cover.src=src; cover.alt=P.name||'';
    cover.onerror=()=>{ cover.style.display='none'; };
  }

  const facts=$('#facts');
  if(facts && Array.isArray(P.facts)){
    facts.innerHTML=P.facts.map(t=>`<li>âœ… ${escapeHtml(t)}</li>`).join('');
  }

  const quiz=$('#quiz');
  if(quiz && Array.isArray(P.questions)){
    quiz.innerHTML=P.questions.map((q,i)=>`
      <div class="q" data-i="${i}">
        <h4 style="margin:0 0 6px">${escapeHtml(q.q)}</h4>
        ${q.a.map((opt,idx)=>`<label style="display:block;margin:6px 0"><input type="radio" name="q${i}" value="${idx}"> ${escapeHtml(opt)}</label>`).join('')}
        <div class="muted res" style="margin-top:6px"></div>
      </div>`).join('');
    const btn=$('#check');
    btn&&btn.addEventListener('click',()=>{
      quiz.querySelectorAll('.q').forEach(box=>{
        const i=+box.dataset.i, ok=(P.questions[i].ok|0);
        const picked=box.querySelector('input[type=radio]:checked');
        const res=box.querySelector('.res');
        if(!picked){res.textContent='Choose an option';return;}
        res.textContent=(+picked.value===ok)?'Correct! ğŸ‰':'Not quite. Try again.';
      });
    });
  }

  const map=$('#map');
  map&&(map.href=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent((P.name||'')+' '+(P.loc||'Turkestan region'))}`);

  // Hide recon block by default (no images yet)
  const recon=document.querySelector('.recon'); if(recon) recon.style.display='none';

  function escapeHtml(s){return String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]))}
});
</script>
<script>
/* Bridge: sync "I was here" with Passport (visited + passport_log) */
(function () {
  const ID   = (window.PLACE && window.PLACE.id) || null;
  const mark = document.getElementById('mark');
  if (!ID || !mark) return;

  const VIS_KEY = 'visited';      // Ğ¾Ğ±ÑŠĞµĞºÑ‚: { [id]: timestamp }
  const LOG_KEY = 'passport_log'; // Ğ¼Ğ°ÑÑĞ¸Ğ²: [{id, date}]

  const readJSON  = (k, d)=>{ try{ const s=localStorage.getItem(k); return s?JSON.parse(s):d; }catch{ return d; } };
  const writeJSON = (k, v)=>{ try{ localStorage.setItem(k, JSON.stringify(v)); }catch{} };

  function isVisited(id){
    const v = readJSON(VIS_KEY, {});
    return !!v[id];
  }
  function setVisited(id, on){
    const v = readJSON(VIS_KEY, {});
    if (on) v[id] = Date.now(); else delete v[id];
    writeJSON(VIS_KEY, v);

    let log = readJSON(LOG_KEY, []);
    if (on){
      if (!log.find(x => x.id === id)) log.push({ id, date: Date.now() });
    } else {
      log = log.filter(x => x.id !== id);
    }
    writeJSON(LOG_KEY, log);
  }
  function syncUI(){
    const on = isVisited(ID);
    mark.dataset.on = on ? '1' : '';
    // i18n-Ñ‚ĞµĞºÑÑ‚, ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ, Ğ¸Ğ½Ğ°Ñ‡Ğµ Ğ°Ğ½Ğ³Ğ».
    const base = (window.I18N && I18N.t) ? I18N.t('place.mark') : 'I was here';
    mark.textContent = on ? (base + ' âœ“') : base;
  }

  mark.addEventListener('click', () => {
    const on = isVisited(ID);
    setVisited(ID, !on);
    syncUI();
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ğ¼ Ğ±ĞµĞ¹Ğ´Ğ¶ Ğ½Ğ° Ğ¸Ğ½Ğ´ĞµĞºÑĞ½Ğ¾Ğ¹, ĞµÑĞ»Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ Ğ² Ñ‚Ğ¾Ğ¹ Ğ¶Ğµ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞµ
    if (window.updateVisitedBadge) {
      try {
        const total = Object.keys(readJSON(VIS_KEY, {})).length;
        updateVisitedBadge(total);
      } catch {}
    }
  });

  // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
  syncUI();
})();
</script>

<script src="../js/place-page.js" defer></script>
</body>
</html>
